<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Static Web Page</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <header>
        <h1>Welcome to the Static Web Page</h1>
        <button id="signup-button">Sign Up</button>
        <button id="login-button">Login</button>
    </header>
    <main id="main-content">
        <p></p>
        <section id="content">
            <p>This is a static web page that connects to APIs.</p>
        </section>
    </main>
    <footer>
        <p>&copy; 2025 Static Web Page</p>
    </footer>
    <script>
      console.log("Inicio de script.");
    
      // Primero, se carga la configuración desde config.json
      fetch("./config.json")
        .then(response => {
          if (!response.ok) {
            throw new Error("Config file not found!");
          }
          return response.json();
        })
        .then(config => {
          // Asignamos la API key a una variable global
          window.INDIGITALL_API_KEY = config.API_KEY;
          console.log("Loaded API Key.");
      
          // Creamos dinámicamente la etiqueta de script para cargar el SDK
          var sdkScript = document.createElement("script");
          sdkScript.src = "/en/indigitall/sdk.min.js";  // Cambia la URL si es necesario
          sdkScript.async = true;  // Lo hacemos asíncrono para no bloquear el renderizado
      
          // Usamos el atributo onload para inicializar el SDK después de cargarlo
          sdkScript.onload = function() {
            indigitall.init({
              appKey: window.INDIGITALL_API_KEY,  // Usamos el appKey cargado desde config.json
            });
            console.log("Indigitall SDK initialized.");
            
            // Llamar a topicsList y topicsSubscribe después de la inicialización
            var topicsCodes = ["incomplete_step1", "incomplete_step2", "incomplete_step3"];
      
            topicsCodes.forEach(topic => {
              indigitall.topicsSubscribe([topic], (response) => {
                console.log(`Subscribed to topic: ${topic}`, response);
              });
            });
          };
      
          // Insertamos el script en el <head> (o en el <body> según convenga)
          document.head.appendChild(sdkScript);
        })
        .catch(error => console.error("Failed to load API key:", error));
    </script>
    

</body>
</html>